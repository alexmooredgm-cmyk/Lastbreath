<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ASTEROID RUNNER ¬∑ SPACE SURVIVAL</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            min-height: 100vh;
            background: radial-gradient(ellipse at 50% 30%, #0a0c2a, #030514);
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Courier New', monospace;
            padding: 10px;
        }

        .game-container {
            max-width: 700px;
            width: 100%;
            background: #0b0e1a;
            border: 3px solid #4afcff;
            border-radius: 50px;
            padding: 20px 15px 25px;
            box-shadow: 0 0 50px cyan, inset 0 0 30px #00a6ff66;
            position: relative;
        }

        .neon-title {
            text-align: center;
            font-size: 2.5rem;
            font-weight: bold;
            letter-spacing: 8px;
            color: #fff;
            text-shadow: 0 0 15px cyan, 0 0 30px blue, 0 0 45px magenta;
            margin-bottom: 5px;
            font-family: 'Segoe UI', monospace;
        }

        .sub-header {
            display: flex;
            justify-content: space-between;
            color: #ffb3ff;
            text-shadow: 0 0 8px hotpink;
            font-size: 1.2rem;
            padding: 0 15px;
            margin-bottom: 15px;
        }

        .stats-panel {
            background: #111a2e;
            border-radius: 40px;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            border: 2px solid #00f7ff;
            box-shadow: 0 0 30px cyan;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .stat {
            text-align: center;
            flex: 1;
            min-width: 70px;
        }

        .stat-label {
            color: #aaddff;
            font-size: 0.8rem;
            letter-spacing: 2px;
        }

        .stat-value {
            color: white;
            font-size: 2rem;
            font-weight: bold;
            text-shadow: 0 0 10px cyan;
            line-height: 1.2;
        }

        .health-bar {
            display: flex;
            gap: 8px;
            justify-content: center;
            align-items: center;
            font-size: 1.8rem;
        }

        .shield-icon {
            color: gold;
            filter: drop-shadow(0 0 10px gold);
            margin-left: 10px;
        }

        #gameCanvas {
            display: block;
            margin: 0 auto;
            width: 100%;
            aspect-ratio: 1 / 1;
            background: #0a0c18;
            border-radius: 40px;
            border: 4px solid #00f7ff;
            box-shadow: 0 0 40px cyan, inset 0 0 30px blue;
            touch-action: none;
        }

        .control-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0 15px;
            gap: 15px;
            flex-wrap: wrap;
        }

        .joystick-area {
            background: #131f3a;
            border-radius: 60px;
            padding: 10px;
            border: 3px solid cyan;
            box-shadow: 0 0 20px cyan;
            display: flex;
            gap: 20px;
        }

        .joy-btn {
            background: #1f2f5a;
            border: 3px solid #00f7ff;
            color: cyan;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            font-size: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 20px cyan;
            cursor: pointer;
            touch-action: manipulation;
        }

        .joy-btn:active {
            background: #3f5fb3;
            transform: scale(0.9);
        }

        .action-btns {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .game-btn {
            background: #1a1f3a;
            border: 3px solid #ff00d4;
            color: white;
            font-size: 1.3rem;
            padding: 12px 22px;
            border-radius: 60px;
            font-weight: bold;
            box-shadow: 0 0 20px magenta;
            cursor: pointer;
            text-transform: uppercase;
        }

        .game-btn:active {
            background: #4f2b9c;
            transform: scale(0.95);
        }

        .powerup-indicator {
            position: absolute;
            top: 110px;
            right: 25px;
            background: #1f1340dd;
            border: 2px solid gold;
            border-radius: 30px;
            padding: 8px 16px;
            color: gold;
            font-weight: bold;
            display: none;
            backdrop-filter: blur(2px);
            z-index: 10;
        }

        .pause-overlay {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #0e1030ee;
            backdrop-filter: blur(5px);
            border: 4px solid cyan;
            border-radius: 50px;
            padding: 35px;
            text-align: center;
            z-index: 100;
        }

        .pause-overlay.show {
            display: block;
        }

        .pause-overlay h2 {
            color: cyan;
            font-size: 3rem;
        }

        .pause-btn {
            background: black;
            border: 2px solid cyan;
            color: cyan;
            font-size: 1.8rem;
            padding: 15px 35px;
            margin: 15px;
            border-radius: 60px;
            width: 100%;
        }

        .leaderboard {
            background: #131f3a;
            border-radius: 30px;
            padding: 15px;
            border: 2px solid cyan;
            margin-top: 20px;
        }

        .leaderboard h3 {
            color: #ff86f5;
            text-align: center;
            font-size: 1.4rem;
        }

        .leaderboard ol {
            color: white;
            padding-left: 25px;
            font-size: 1.2rem;
        }

        @media (max-width: 500px) {
            .joy-btn { width: 50px; height: 50px; font-size: 1.8rem; }
            .game-btn { font-size: 1rem; padding: 8px 16px; }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="neon-title">ASTEROID RUNNER</div>
        <div class="sub-header">
            <span>üöÄ ENDLESS RUN</span>
            <span>üí´ DEEP SPACE</span>
        </div>

        <div class="stats-panel">
            <div class="stat">
                <div class="stat-label">DISTANCE</div>
                <div class="stat-value" id="distanceDisplay">0</div>
            </div>
            <div class="stat">
                <div class="stat-label">SCORE</div>
                <div class="stat-value" id="scoreDisplay">0</div>
            </div>
            <div class="stat">
                <div class="stat-label">‚ù§Ô∏è</div>
                <div class="health-bar" id="healthDisplay">
                    <span>‚ù§Ô∏è</span><span>‚ù§Ô∏è</span><span>‚ù§Ô∏è</span>
                </div>
            </div>
        </div>

        <canvas id="gameCanvas" width="600" height="600"></canvas>

        <div id="powerupIndicator" class="powerup-indicator"></div>

        <!-- Mobile Controls -->
        <div class="control-row">
            <div class="joystick-area">
                <div class="joy-btn" id="moveLeft">‚óÄ</div>
                <div class="joy-btn" id="moveRight">‚ñ∂</div>
            </div>
            
            <div class="action-btns">
                <button class="game-btn" id="pauseBtn">‚è∏Ô∏è PAUSE</button>
                <button class="game-btn" id="restartBtn">üîÑ RESTART</button>
            </div>
        </div>

        <!-- Leaderboard -->
        <div class="leaderboard">
            <h3>üèÜ TOP PILOTS</h3>
            <ol id="leaderboardList">
                <li>??? - 0</li>
            </ol>
        </div>

        <!-- Pause Menu -->
        <div class="pause-overlay" id="pauseMenu">
            <h2>‚è∏ PAUSED</h2>
            <button class="game-btn pause-btn" id="resumeBtn">‚ñ∂ RESUME</button>
            <button class="game-btn pause-btn" id="restartFromPause">üîÑ RESTART</button>
        </div>
    </div>

    <script>
        (function() {
            // ========== CONFIG ==========
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');
            
            // Player
            let player = {
                x: 300,
                y: 300,
                radius: 15,
                speed: 5
            };
            
            // Health system
            let health = 3;
            let maxHealth = 3;
            let invincible = 0;
            
            // Auto-shoot
            let bullets = [];
            const bulletSpeed = 8;
            const bulletSize = 5;
            let lastShot = 0;
            const shotDelay = 10; // frames
            
            // Power-ups
            let activePowerup = null;
            let powerupTimer = 0;
            let doubleShot = false;
            let shieldActive = false;
            let laserBeam = false;
            let scoreMultiplier = 1;
            
            // Asteroids
            let asteroids = [];
            let baseSpeed = 3;
            let speedMultiplier = 1;
            
            // Distance/Score
            let distance = 0;
            let score = 0;
            let highScore = localStorage.getItem('asteroidHighScore') || 0;
            highScore = parseInt(highScore);
            
            // Leaderboard
            let leaderboard = JSON.parse(localStorage.getItem('asteroidLeaderboard')) || [];
            
            // Game state
            let gameOver = false;
            let paused = false;
            let gameLoop;
            let animationFrame;
            
            // Movement flags
            let moveLeft = false;
            let moveRight = false;
            
            // Stars for parallax
            let stars = [];
            for (let i = 0; i < 100; i++) {
                stars.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    size: Math.random() * 2 + 1,
                    speed: Math.random() * 2 + 1
                });
            }
            
            // ========== INIT ==========
            function spawnAsteroid(isBoss = false) {
                const size = isBoss ? 80 : (Math.random() * 30 + 20);
                const x = Math.random() * (canvas.width - 100) + 50;
                
                asteroids.push({
                    x: x,
                    y: -size,
                    size: size,
                    speed: (baseSpeed + Math.random() * 2) * speedMultiplier,
                    health: isBoss ? 10 : (size > 40 ? 3 : 1),
                    maxHealth: isBoss ? 10 : (size > 40 ? 3 : 1),
                    isBoss: isBoss || false,
                    points: isBoss ? 500 : (size > 40 ? 100 : 50)
                });
            }
            
            function spawnBoss() {
                spawnAsteroid(true);
            }
            
            // ========== UPDATE ==========
            function updateGame() {
                if (gameOver || paused) return;
                
                // Distance increases over time
                distance += 0.5;
                score += Math.floor(distance / 100) + 1;
                
                // Update power-up timer
                if (powerupTimer > 0) {
                    powerupTimer--;
                    if (powerupTimer <= 0) {
                        deactivatePowerups();
                    }
                }
                
                // Player movement
                if (moveLeft) player.x -= player.speed;
                if (moveRight) player.x += player.speed;
                player.x = Math.max(player.radius, Math.min(canvas.width - player.radius, player.x));
                
                // Auto-fire
                if (lastShot <= 0) {
                    if (laserBeam) {
                        // Laser beam - hits all asteroids in line
                        bullets.push({
                            x: player.x,
                            y: 0,
                            width: 10,
                            height: canvas.height,
                            isLaser: true,
                            life: 10
                        });
                    } else if (doubleShot) {
                        bullets.push({
                            x: player.x - 15,
                            y: player.y,
                            vx: 0,
                            vy: -bulletSpeed,
                            size: bulletSize
                        });
                        bullets.push({
                            x: player.x + 15,
                            y: player.y,
                            vx: 0,
                            vy: -bulletSpeed,
                            size: bulletSize
                        });
                    } else {
                        bullets.push({
                            x: player.x,
                            y: player.y,
                            vx: 0,
                            vy: -bulletSpeed,
                            size: bulletSize
                        });
                    }
                    lastShot = shotDelay;
                } else {
                    lastShot--;
                }
                
                // Update stars (parallax)
                stars.forEach(s => {
                    s.y += s.speed;
                    if (s.y > canvas.height) {
                        s.y = 0;
                        s.x = Math.random() * canvas.width;
                    }
                });
                
                // Update bullets
                bullets = bullets.filter(b => {
                    if (b.isLaser) {
                        b.life--;
                        return b.life > 0;
                    }
                    b.y += b.vy;
                    return b.y > -20;
                });
                
                // Update asteroids
                asteroids = asteroids.filter(a => {
                    a.y += a.speed;
                    
                    // Check bullet collision
                    for (let i = bullets.length - 1; i >= 0; i--) {
                        const b = bullets[i];
                        if (b.isLaser) {
                            // Laser hits everything
                            if (a.y + a.size > 0 && a.y < canvas.height) {
                                a.health--;
                                if (a.health <= 0) {
                                    score += a.points * scoreMultiplier;
                                    if (a.isBoss) {
                                        // Spawn power-up
                                        activateRandomPowerup();
                                    } else if (Math.random() < 0.1) {
                                        activateRandomPowerup();
                                    }
                                    return false;
                                }
                                bullets.splice(i, 1);
                                break;
                            }
                        } else {
                            const dist = Math.hypot(b.x - a.x, b.y - a.y);
                            if (dist < a.size/2 + b.size/2) {
                                a.health--;
                                bullets.splice(i, 1);
                                if (a.health <= 0) {
                                    score += a.points * scoreMultiplier;
                                    if (a.isBoss) {
                                        activateRandomPowerup();
                                    } else if (Math.random() < 0.1) {
                                        activateRandomPowerup();
                                    }
                                    return false;
                                }
                                break;
                            }
                        }
                    }
                    
                    // Check player collision
                    if (invincible <= 0) {
                        const dist = Math.hypot(player.x - a.x, player.y - a.y);
                        if (dist < a.size/2 + player.radius) {
                            if (shieldActive) {
                                shieldActive = false;
                                document.getElementById('powerupIndicator').style.display = 'none';
                            } else {
                                health--;
                                invincible = 60; // 1 second
                                
                                if (health <= 0) {
                                    gameOver = true;
                                    updateLeaderboard(score);
                                }
                            }
                        }
                    }
                    
                    // Remove if off screen
                    return a.y < canvas.height + a.size;
                });
                
                // Spawn asteroids based on distance
                if (Math.random() < 0.02 + (distance / 10000)) {
                    if (distance > 1000 && Math.random() < 0.1) {
                        spawnBoss();
                    } else {
                        spawnAsteroid();
                    }
                }
                
                // Increase difficulty
                speedMultiplier = 1 + (distance / 2000);
                
                // Update displays
                document.getElementById('distanceDisplay').innerText = Math.floor(distance);
                document.getElementById('scoreDisplay').innerText = score;
                updateHealthDisplay();
                
                // Update invincibility
                if (invincible > 0) invincible--;
            }
            
            function deactivatePowerups() {
                doubleShot = false;
                shieldActive = false;
                laserBeam = false;
                scoreMultiplier = 1;
                activePowerup = null;
                document.getElementById('powerupIndicator').style.display = 'none';
            }
            
            function activateRandomPowerup() {
                const r = Math.random();
                powerupTimer = 300; // 5 seconds
                
                if (r < 0.25) {
                    doubleShot = true;
                    scoreMultiplier = 2;
                    activePowerup = 'double';
                    document.getElementById('powerupIndicator').innerHTML = 'üî´ DOUBLE SHOT';
                } else if (r < 0.5) {
                    shieldActive = true;
                    activePowerup = 'shield';
                    document.getElementById('powerupIndicator').innerHTML = 'üõ°Ô∏è SHIELD';
                } else if (r < 0.75) {
                    laserBeam = true;
                    scoreMultiplier = 3;
                    activePowerup = 'laser';
                    document.getElementById('powerupIndicator').innerHTML = '‚ö° LASER BEAM';
                } else {
                    scoreMultiplier = 5;
                    activePowerup = 'multiplier';
                    document.getElementById('powerupIndicator').innerHTML = '‚ú® 5X MULTIPLIER';
                }
                
                document.getElementById('powerupIndicator').style.display = 'block';
            }
            
            function updateHealthDisplay() {
                const healthEl = document.getElementById('healthDisplay');
                let hearts = '';
                for (let i = 0; i < maxHealth; i++) {
                    if (i < health) {
                        hearts += '<span style="color: #ff4d4d;">‚ù§Ô∏è</span>';
                    } else {
                        hearts += '<span style="color: #ff4d4d; opacity: 0.3;">‚ù§Ô∏è</span>';
                    }
                }
                if (shieldActive) hearts += '<span class="shield-icon">üõ°Ô∏è</span>';
                healthEl.innerHTML = hearts;
            }
            
            // ========== RENDERING ==========
            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // Draw stars
                ctx.fillStyle = 'white';
                stars.forEach(s => {
                    ctx.beginPath();
                    ctx.arc(s.x, s.y, s.size, 0, Math.PI*2);
                    ctx.fill();
                });
                
                // Draw bullets
                bullets.forEach(b => {
                    if (b.isLaser) {
                        ctx.fillStyle = '#ffff00';
                        ctx.shadowColor = 'yellow';
                        ctx.shadowBlur = 30;
                        ctx.fillRect(b.x - 5, 0, 10, canvas.height);
                    } else {
                        ctx.fillStyle = '#ffff00';
                        ctx.shadowColor = 'yellow';
                        ctx.shadowBlur = 15;
                        ctx.beginPath();
                        ctx.arc(b.x, b.y, b.size/2, 0, Math.PI*2);
                        ctx.fill();
                    }
                });
                
                // Draw asteroids
                asteroids.forEach(a => {
                    // Gradient for asteroid
                    const gradient = ctx.createRadialGradient(a.x - 10, a.y - 10, 5, a.x, a.y, a.size);
                    gradient.addColorStop(0, '#8b8b8b');
                    gradient.addColorStop(1, '#4a4a4a');
                    
                    ctx.fillStyle = gradient;
                    ctx.shadowColor = a.isBoss ? 'red' : '#8b8b8b';
                    ctx.shadowBlur = a.isBoss ? 40 : 20;
                    
                    ctx.beginPath();
                    ctx.ellipse(a.x, a.y, a.size/2, a.size/2.5, 0, 0, Math.PI*2);
                    ctx.fill();
                    
                    // Health bar for boss
                    if (a.isBoss) {
                        ctx.fillStyle = '#00ff00';
                        ctx.shadowBlur = 0;
                        ctx.fillRect(a.x - a.size/2, a.y - a.size/2 - 10, a.size * (a.health / a.maxHealth), 5);
                    }
                    
                    // Craters
                    ctx.fillStyle = '#5a5a5a';
                    ctx.shadowBlur = 5;
                    ctx.beginPath();
                    ctx.arc(a.x - 10, a.y - 5, a.size/5, 0, Math.PI*2);
                    ctx.fill();
                    ctx.beginPath();
                    ctx.arc(a.x + 8, a.y + 5, a.size/6, 0, Math.PI*2);
                    ctx.fill();
                });
                
                // Draw player ship
                ctx.shadowColor = shieldActive ? 'gold' : 'cyan';
                ctx.shadowBlur = 30;
                
                // Draw ship (triangle)
                ctx.fillStyle = '#00ffff';
                ctx.beginPath();
                ctx.moveTo(player.x, player.y - player.radius * 1.5);
                ctx.lineTo(player.x + player.radius, player.y + player.radius/2);
                ctx.lineTo(player.x - player.radius, player.y + player.radius/2);
                ctx.closePath();
                ctx.fill();
                
                // Engine trail
                ctx.fillStyle = '#ffaa00';
                ctx.shadowColor = 'orange';
                ctx.beginPath();
                ctx.moveTo(player.x - 5, player.y + player.radius/2);
                ctx.lineTo(player.x, player.y + player.radius);
                ctx.lineTo(player.x + 5, player.y + player.radius/2);
                ctx.fill();
                
                // Invincibility flash
                if (invincible > 0 && invincible % 10 < 5) {
                    ctx.strokeStyle = 'white';
                    ctx.lineWidth = 3;
                    ctx.shadowBlur = 40;
                    ctx.beginPath();
                    ctx.arc(player.x, player.y, player.radius + 5, 0, Math.PI*2);
                    ctx.stroke();
                }
                
                ctx.shadowBlur = 0;
                
                // Game over overlay
                if (gameOver) {
                    ctx.fillStyle = '#000000aa';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    ctx.fillStyle = 'white';
                    ctx.font = 'bold 40px monospace';
                    ctx.textAlign = 'center';
                    ctx.fillText('GAME OVER', canvas.width/2, canvas.height/2);
                    ctx.font = '20px monospace';
                    ctx.fillText('Distance: ' + Math.floor(distance), canvas.width/2, canvas.height/2 + 50);
                }
                
                animationFrame = requestAnimationFrame(draw);
            }
            
            // ========== LEADERBOARD ==========
            function updateLeaderboard(finalScore) {
                leaderboard.push(finalScore);
                leaderboard.sort((a,b) => b - a);
                leaderboard = leaderboard.slice(0, 5);
                localStorage.setItem('asteroidLeaderboard', JSON.stringify(leaderboard));
                
                if (finalScore > highScore) {
                    highScore = finalScore;
                    localStorage.setItem('asteroidHighScore', highScore);
                }
                
                renderLeaderboard();
            }
            
            function renderLeaderboard() {
                const list = document.getElementById('leaderboardList');
                if (leaderboard.length === 0) {
                    list.innerHTML = '<li>??? - 0</li>';
                } else {
                    list.innerHTML = leaderboard.map(s => `<li>üë§ ${s}</li>`).join('');
                }
            }
            
            // ========== CONTROLS ==========
            document.getElementById('moveLeft').addEventListener('mousedown', () => moveLeft = true);
            document.getElementById('moveLeft').addEventListener('mouseup', () => moveLeft = false);
            document.getElementById('moveLeft').addEventListener('mouseleave', () => moveLeft = false);
            document.getElementById('moveRight').addEventListener('mousedown', () => moveRight = true);
            document.getElementById('moveRight').addEventListener('mouseup', () => moveRight = false);
            document.getElementById('moveRight').addEventListener('mouseleave', () => moveRight = false);
            
            // Touch events
            ['moveLeft', 'moveRight'].forEach(id => {
                const btn = document.getElementById(id);
                btn.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    if (id === 'moveLeft') moveLeft = true;
                    if (id === 'moveRight') moveRight = true;
                });
                btn.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    if (id === 'moveLeft') moveLeft = false;
                    if (id === 'moveRight') moveRight = false;
                });
            });
            
            // Keyboard
            window.addEventListener('keydown', (e) => {
                const key = e.key;
                e.preventDefault();
                if (key === 'ArrowLeft') moveLeft = true;
                if (key === 'ArrowRight') moveRight = true;
                if (key === 'p' || key === ' ') togglePause();
            });
            
            window.addEventListener('keyup', (e) => {
                const key = e.key;
                if (key === 'ArrowLeft') moveLeft = false;
                if (key === 'ArrowRight') moveRight = false;
            });
            
            function togglePause() {
                paused = !paused;
                document.getElementById('pauseMenu').classList.toggle('show', paused);
                document.getElementById('pauseBtn').innerText = paused ? '‚ñ∂Ô∏è RESUME' : '‚è∏Ô∏è PAUSE';
            }
            
            document.getElementById('pauseBtn').addEventListener('click', togglePause);
            document.getElementById('resumeBtn').addEventListener('click', togglePause);
            
            function restartGame() {
                // Reset all state
                player = { x: 300, y: 300, radius: 15, speed: 5 };
                health = 3;
                invincible = 0;
                bullets = [];
                asteroids = [];
                distance = 0;
                score = 0;
                speedMultiplier = 1;
                gameOver = false;
                paused = false;
                
                deactivatePowerups();
                
                document.getElementById('distanceDisplay').innerText = '0';
                document.getElementById('scoreDisplay').innerText = '0';
                document.getElementById('pauseMenu').classList.remove('show');
                document.getElementById('pauseBtn').innerText = '‚è∏Ô∏è PAUSE';
                
                updateHealthDisplay();
            }
            
            document.getElementById('restartBtn').addEventListener('click', restartGame);
            document.getElementById('restartFromPause').addEventListener('click', restartGame);
            
            // ========== START GAME ==========
            function init() {
                renderLeaderboard();
                updateHealthDisplay();
                
                // Spawn initial asteroids
                for (let i = 0; i < 3; i++) {
                    setTimeout(() => spawnAsteroid(), i * 500);
                }
                
                gameLoop = setInterval(() => updateGame(), 1000/60);
                draw();
            }
            
            init();
            
            window.addEventListener('beforeunload', () => {
                clearInterval(gameLoop);
                cancelAnimationFrame(animationFrame);
            });
        })();
    </script>
</body>
</html>